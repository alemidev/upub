#!/bin/bash

echo "building release binary"
cargo build --release --all-features
echo "stopping service"
systemctl --user stop upub
echo "installing new binary"
cat ./target/release/upub > /opt/bin/upub
echo "applying migrations"
/opt/bin/upub --database /srv/tci/upub.db migrate
echo "restarting service"
systemctl --user start upub
echo "done"
